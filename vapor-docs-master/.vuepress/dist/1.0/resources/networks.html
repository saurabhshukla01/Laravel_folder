<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Networks | Laravel Vapor</title>
    <meta name="description" content="Laravel at Infinite Scale">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,800,800i,900,900i" rel="stylesheet" type="text/css">
    
    <link rel="preload" href="/assets/css/0.styles.5f56b249.css" as="style"><link rel="preload" href="/assets/js/app.04c28b41.js" as="script"><link rel="preload" href="/assets/js/14.71ca6a0b.js" as="script"><link rel="prefetch" href="/assets/js/2.d8d0300f.js"><link rel="prefetch" href="/assets/js/3.1e4f069b.js"><link rel="prefetch" href="/assets/js/4.2a44fc6e.js"><link rel="prefetch" href="/assets/js/5.bd43df2b.js"><link rel="prefetch" href="/assets/js/6.bb590f0e.js"><link rel="prefetch" href="/assets/js/7.9f494098.js"><link rel="prefetch" href="/assets/js/8.10bf06b4.js"><link rel="prefetch" href="/assets/js/9.5749b881.js"><link rel="prefetch" href="/assets/js/10.ba4cbb16.js"><link rel="prefetch" href="/assets/js/11.a9c00747.js"><link rel="prefetch" href="/assets/js/12.501407a6.js"><link rel="prefetch" href="/assets/js/13.b8a68b57.js"><link rel="prefetch" href="/assets/js/15.fe70809a.js"><link rel="prefetch" href="/assets/js/16.3dc841f8.js"><link rel="prefetch" href="/assets/js/17.fade3e51.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5f56b249.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Laravel Vapor</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://vapor.laravel.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://vapor.laravel.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/1.0/introduction.html" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/introduction.html#what-is-vapor" class="sidebar-link">What Is Vapor?</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#account-creation" class="sidebar-link">Account Creation</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#installing-the-vapor-cli" class="sidebar-link">Installing The Vapor CLI</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#installing-the-vapor-core" class="sidebar-link">Installing The Vapor Core</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#teams" class="sidebar-link">Teams</a></li><li class="sidebar-sub-header"><a href="/1.0/introduction.html#linking-with-aws" class="sidebar-link">Linking With AWS</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Projects</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/1.0/projects/the-basics.html" class="sidebar-link">The Basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/the-basics.html#creating-projects" class="sidebar-link">Creating Projects</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/the-basics.html#project-settings" class="sidebar-link">Project Settings</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/the-basics.html#deleting-projects" class="sidebar-link">Deleting Projects</a></li></ul></li><li><a href="/1.0/projects/environments.html" class="sidebar-link">Environments</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#creating-environments" class="sidebar-link">Creating Environments</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#environment-variables" class="sidebar-link">Environment Variables</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#secrets" class="sidebar-link">Secrets</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#vanity-urls" class="sidebar-link">Vanity URLs</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#custom-domains" class="sidebar-link">Custom Domains</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#maintenance-mode" class="sidebar-link">Maintenance Mode</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#commands" class="sidebar-link">Commands</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#prewarming" class="sidebar-link">Prewarming</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#concurrency" class="sidebar-link">Concurrency</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/environments.html#deleting-environments" class="sidebar-link">Deleting Environments</a></li></ul></li><li><a href="/1.0/projects/deployments.html" class="sidebar-link">Deployments</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#initiating-deployments" class="sidebar-link">Initiating Deployments</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#build-hooks" class="sidebar-link">Build Hooks</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#deploy-hooks" class="sidebar-link">Deploy Hooks</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#assets" class="sidebar-link">Assets</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#redeploying" class="sidebar-link">Redeploying</a></li><li class="sidebar-sub-header"><a href="/1.0/projects/deployments.html#rollbacks" class="sidebar-link">Rollbacks</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Resources</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/1.0/resources/queues.html" class="sidebar-link">Queues</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-concurrency" class="sidebar-link">Queue Concurrency</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/queues.html#queue-visibility-timeout" class="sidebar-link">Queue Visibility Timeout</a></li></ul></li><li><a href="/1.0/resources/storage.html" class="sidebar-link">Storage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#attaching-storage" class="sidebar-link">Attaching Storage</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/storage.html#file-uploads" class="sidebar-link">File Uploads</a></li></ul></li><li><a href="/1.0/resources/networks.html" class="active sidebar-link">Networks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#jumpboxes" class="sidebar-link">Jumpboxes</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#nat-gateways" class="sidebar-link">NAT Gateways</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/networks.html#load-balancers" class="sidebar-link">Load Balancers</a></li></ul></li><li><a href="/1.0/resources/databases.html" class="sidebar-link">Databases</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#creating-databases" class="sidebar-link">Creating Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#using-databases" class="sidebar-link">Using Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#database-users" class="sidebar-link">Database Users</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#scaling-databases" class="sidebar-link">Scaling Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#restoring-databases" class="sidebar-link">Restoring Databases</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/databases.html#deleting-databases" class="sidebar-link">Deleting Databases</a></li></ul></li><li><a href="/1.0/resources/caches.html" class="sidebar-link">Caches</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#creating-caches" class="sidebar-link">Creating Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#using-caches" class="sidebar-link">Using Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#scaling-caches" class="sidebar-link">Scaling Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#dynamodb-caches" class="sidebar-link">DynamoDB Caches</a></li><li class="sidebar-sub-header"><a href="/1.0/resources/caches.html#deleting-caches" class="sidebar-link">Deleting Caches</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Domains</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/1.0/domains/registrar.html" class="sidebar-link">Registrar</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/domains/registrar.html#introduction" class="sidebar-link">Introduction</a></li></ul></li><li><a href="/1.0/domains/dns.html" class="sidebar-link">DNS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#creating-dns-zones" class="sidebar-link">Creating DNS Zones</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#nameservers" class="sidebar-link">Nameservers</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#managing-dns-records" class="sidebar-link">Managing DNS Records</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/dns.html#deleting-zones" class="sidebar-link">Deleting Zones</a></li></ul></li><li><a href="/1.0/domains/certificates.html" class="sidebar-link">Certificates</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/1.0/domains/certificates.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/certificates.html#creating-certificates" class="sidebar-link">Creating Certificates</a></li><li class="sidebar-sub-header"><a href="/1.0/domains/certificates.html#deleting-certificates" class="sidebar-link">Deleting Certificates</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="networks"><a href="#networks" aria-hidden="true" class="header-anchor">#</a> Networks</h1> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#jumpboxes">Jumpboxes</a></li><li><a href="#nat-gateways">NAT Gateways</a><ul><li><a href="#what-are-they">What Are They?</a></li><li><a href="#managing-nat-gateways">Managing NAT Gateways</a></li></ul></li><li><a href="#load-balancers">Load Balancers</a><ul><li><a href="#creating-load-balancers">Creating Load Balancers</a></li><li><a href="#using-load-balancers">Using Load Balancers</a></li><li><a href="#deleting-load-balancers">Deleting Load Balancers</a></li></ul></li></ul></div><p></p> <h2 id="introduction"><a href="#introduction" aria-hidden="true" class="header-anchor">#</a> Introduction</h2> <p>Networks house your databases, caches, jumpboxes, and occasionally applications within AWS. In general, although they are displayed in the Vapor UI for you to review, you are not required to interact with networks directly when using Vapor. When you create a project in a region that does not contain any previous Vapor projects, Vapor automatically begins provisioning a network for you.</p> <h2 id="jumpboxes"><a href="#jumpboxes" aria-hidden="true" class="header-anchor">#</a> Jumpboxes</h2> <p>Some Vapor resources, such as private databases or cache clusters, may not be accessed from the public Internet. Instead, they can only be accessed by a machine with their network. This can make it cumbersome to inspect and manipulate these resources during development. To mitigate this inconvenience, Vapor allows you to create jumpboxes. Jumpboxes are very small, SSH accessible servers that are placed within your private network.</p> <p>You may create a jumpbox via the Vapor UI's network detail screen or using the <code>jump</code> CLI command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor jump my-jumpbox
</code></pre></div><p>Once the jumpbox has been created, Vapor will provide you with the private SSH key needed to access the jumpbox. You should connect to the jumpbox via SSH as the <code>ec2-user</code> user and the private SSH key.</p> <div class="tip custom-block"><p class="custom-block-title">Using Jumpboxes</p> <p>For practical examples of using jumpboxes to make your serverless life easier, check out the <a href="/1.0/resources/databases.html#using-databases">database</a> and <a href="/1.0/resources/caches.html#using-caches">cache</a> documentation.</p></div> <h2 id="nat-gateways"><a href="#nat-gateways" aria-hidden="true" class="header-anchor">#</a> NAT Gateways</h2> <h3 id="what-are-they"><a href="#what-are-they" aria-hidden="true" class="header-anchor">#</a> What Are They?</h3> <p>If you application interacts with a private database or a cache cluster, your network will require a NAT Gateway. It sounds complicated, but don't worry, Vapor takes care of the heavy lifting. In summary, when a serverless application needs to interact with one of these resources, AWS requires us to place that application within that region's network. By default, this network has no access to the outside Internet, meaning any outgoing API calls from your application will fail. Not good.</p> <h3 id="managing-nat-gateways"><a href="#managing-nat-gateways" aria-hidden="true" class="header-anchor">#</a> Managing NAT Gateways</h3> <p>Anytime you deploy an application that lists a private database or cache cluster as an attached resource within its <code>vapor.yml</code> file, Vapor will automatically ensure that the network associated with that database / cache contains a NAT Gateway. If it doesn't, Vapor will automatically begin provisioning one. Unfortunately, AWS bills for NAT Gateways by the hour, resulting in a monthly fee of about $32 / month.</p> <p>To totally avoid using NAT Gateways, you can use publicly accessible RDS databases (Vapor automatically assigns a long, random password) and a <a href="/1.0/resources/caches.html#dynamodb-caches">DynamoDB cache table</a>, which Vapor automatically creates for each of your projects.</p> <p>When you delete a private database or cache cluster, and that resource is the last private resource on a given network, Vapor will automatically schedule a job to remove the NAT Gateway from the associated network, thus removing it from your AWS bill. However, you may also manually add or remove NAT Gateways from your networks using the Vapor UI or using the <code>network:nat</code> and <code>network:delete-nat</code> CLI commands.</p> <h2 id="load-balancers"><a href="#load-balancers" aria-hidden="true" class="header-anchor">#</a> Load Balancers</h2> <p>By default, Vapor routes HTTP traffic to your serverless applications using AWS API Gateway. When using this service, AWS only bills you based on the amount of requests your application receives. However, at very high scale, API Gateway can become more expensive then your Lambda functions themselves.</p> <p>As an alternative to API Gateway, you may route traffic to your application using an Application Load Balancer, which provides large cost savings at scale. For example, if an application receives about 1 billion requests per month, using an Application Load Balancer will save about $4,000 on the application's monthly Amazon bill.</p> <h3 id="creating-load-balancers"><a href="#creating-load-balancers" aria-hidden="true" class="header-anchor">#</a> Creating Load Balancers</h3> <p>You may create load balancers using the Vapor UI or using the <code>balancer</code> CLI command. When using the CLI command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor balancer my-balancer
</code></pre></div><h3 id="using-load-balancers"><a href="#using-load-balancers" aria-hidden="true" class="header-anchor">#</a> Using Load Balancers</h3> <p>To attach a load balancer to an environment, add a <code>balancer</code> key to the environment's configuration in your <code>vapor.yml</code> file and deploy your application. The value of this key should be the name of the load balancer.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">3</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> vapor<span class="token punctuation">-</span>app
<span class="token key atrule">environments</span><span class="token punctuation">:</span>
    <span class="token key atrule">production</span><span class="token punctuation">:</span>
        <span class="token key atrule">balancer</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>balancer
        <span class="token key atrule">build</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'composer install --no-dev --classmap-authoritative'</span>
        <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'php artisan migrate --force'</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">Load Balancer Certificates</p> <p>By default, Vapor creates all SSL certificates in the <code>us-east-1</code> region, regardless of the region of your project. When your application is using API Gateway, AWS will automatically replicate your certificate to all regions behind the scenes.</p> <p>However, when using an Application Load Balancer to route traffic to your application, you will need to create a certificate in the region that the project is actually deployed to. If you are creating a certificate in the Vapor UI, you can do this by checking the &quot;For Load Balancer&quot; checkbox when creating the certificate.</p></div> <h3 id="deleting-load-balancers"><a href="#deleting-load-balancers" aria-hidden="true" class="header-anchor">#</a> Deleting Load Balancers</h3> <p>Load balancers may be deleted via the Vapor UI or using the <code>balancer:delete</code> CLI command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vapor balancer:delete my-balancer
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/1.0/resources/storage.html" class="prev">
          Storage
        </a></span> <span class="next"><a href="/1.0/resources/databases.html">
          Databases
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/14.71ca6a0b.js" defer></script><script src="/assets/js/app.04c28b41.js" defer></script>
  </body>
</html>
