(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{176:function(t,a,s){"use strict";s.r(a);var e=s(0),n=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"queues"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#queues","aria-hidden":"true"}},[t._v("#")]),t._v(" Queues")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#introduction"}},[t._v("Introduction")])]),s("li",[s("a",{attrs:{href:"#queue-concurrency"}},[t._v("Queue Concurrency")])]),s("li",[s("a",{attrs:{href:"#queue-visibility-timeout"}},[t._v("Queue Visibility Timeout")])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"introduction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#introduction","aria-hidden":"true"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),s("p",[t._v("Laravel's queues are one of the framework's most powerful features. With Vapor, you can continue writing and dispatching queued jobs exactly as you would in a traditional server-hosted Laravel application. The only difference is that Vapor will automatically scale your queue processing throughput on-demand within seconds:")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{attrs:{class:"token package"}},[t._v("App"),s("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Jobs"),s("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ProcessPodcast")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nProcessPodcast"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token function"}},[t._v("dispatch")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token variable"}},[t._v("$pocast")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("When using Vapor, your application will use the AWS SQS service, which is already a first-party queue driver within Laravel. Vapor will automatically configure your deployed application's to use this queue driver by injecting the proper Laravel environment variables. You do not need to perform any additional configuration.")]),t._v(" "),s("div",{staticClass:"danger custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Queued Job Time Limits")]),t._v(" "),s("p",[t._v("Currently, serverless applications on AWS may only process a single request (web or queue) for a maximum of 15 minutes. If your queued jobs take longer than 15 minutes, you will need to either chunk your job's work into smaller pieces or consider another deployment solution for your application.")])]),t._v(" "),s("h2",{attrs:{id:"queue-concurrency"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#queue-concurrency","aria-hidden":"true"}},[t._v("#")]),t._v(" Queue Concurrency")]),t._v(" "),s("p",[t._v("By default, Vapor will allow your queue to process jobs at max concurrency, which is typically 1,000 concurrent jobs executing at the same time. If you would like to reduce the maximum queue concurrency, you may define the "),s("code",[t._v("cli-concurrency")]),t._v(" option in the environment's "),s("code",[t._v("vapor.yml")]),t._v(" configuration:")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{attrs:{class:"token key atrule"}},[t._v("id")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vapor"),s("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v("laravel"),s("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v("app\n"),s("span",{attrs:{class:"token key atrule"}},[t._v("environments")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{attrs:{class:"token key atrule"}},[t._v("production")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{attrs:{class:"token key atrule"}},[t._v("cli-concurrency")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("50")]),t._v("\n        "),s("span",{attrs:{class:"token key atrule"}},[t._v("build")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'composer install --no-dev --classmap-authoritative'")]),t._v("\n")])])]),s("h2",{attrs:{id:"queue-visibility-timeout"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#queue-visibility-timeout","aria-hidden":"true"}},[t._v("#")]),t._v(" Queue Visibility Timeout")]),t._v(" "),s("p",[t._v('By default, if your queued job is not deleted or released within one minute of beginning to process, SQS will retry the job. To configure this "visibility timeout", you may define the '),s("code",[t._v("queue-timeout")]),t._v(" option in the environment's "),s("code",[t._v("vapor.yml")]),t._v(" configuration. For example, we may set this timeout to five minutes:")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{attrs:{class:"token key atrule"}},[t._v("id")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vapor"),s("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v("laravel"),s("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v("app\n"),s("span",{attrs:{class:"token key atrule"}},[t._v("environments")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{attrs:{class:"token key atrule"}},[t._v("production")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{attrs:{class:"token key atrule"}},[t._v("queue-timeout")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("300")]),t._v("\n        "),s("span",{attrs:{class:"token key atrule"}},[t._v("build")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'composer install --no-dev --classmap-authoritative'")]),t._v("\n")])])])])}],!1,null,null,null);a.default=n.exports}}]);